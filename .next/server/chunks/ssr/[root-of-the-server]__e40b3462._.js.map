{"version":3,"sources":["../../../../app/%28with-nav%29/poetry/%5Bslug%5D/page.jsx","../../../../app/utils/getPoemMetadata.js"],"sourcesContent":["import fs from \"fs\";\r\nimport matter from \"gray-matter\";\r\nimport ReactMarkdown from \"react-markdown\";\r\nimport remarkGfm from \"remark-gfm\";\r\nimport { notFound } from \"next/navigation\";\r\nimport getPoemMetadata from \"@/app/utils/getPoemMetadata\";\r\n\r\nfunction getPoem(slug) {\r\n    const path = `data/poems/${slug}.md`;\r\n\r\n    if (!fs.existsSync(path)) notFound();\r\n\r\n    return matter(fs.readFileSync(path, \"utf8\"));\r\n}\r\n\r\nexport async function generateStaticParams() {\r\n    const poems = getPoemMetadata(\"data/poems\");\r\n    return poems.map(p => ({ slug: p.slug }));\r\n}\r\n\r\nexport default async function PoemPage({ params }) {\r\n    const { slug } = await params;\r\n    const poem = getPoem(slug);\r\n\r\n    return (\r\n        <article className=\"post-content poetry\">\r\n        <h1>{poem.data.title}</h1>\r\n\r\n        <ReactMarkdown remarkPlugins={[remarkGfm]}>\r\n            {poem.content}\r\n        </ReactMarkdown>\r\n        </article>\r\n    );\r\n}\r\n","import fs from \"fs\";\r\nimport matter from \"gray-matter\";\r\n\r\nfunction extractExcerpt(content, maxWords = 12) {\r\n    const text = content\r\n        .replace(/[#>*_`]/g, \"\")\r\n        .replace(/\\n+/g, \" \")\r\n        .trim();\r\n\r\n    return text.split(\" \").slice(0, maxWords).join(\" \");\r\n}\r\n\r\nexport default function getPoemMetadata(basePath) {\r\n    const files = fs.readdirSync(basePath).filter(f => f.endsWith(\".md\"));\r\n    const now = new Date();\r\n\r\n    const poems = files\r\n        .map((filename) => {\r\n        const file = fs.readFileSync(`${basePath}/${filename}`, \"utf8\");\r\n        const { data, content } = matter(file);\r\n        const poemDate = data.date ? new Date(data.date) : null;\r\n        console.log('showing time: ' + (poemDate));\r\n        return {\r\n            title: data.title,\r\n            date: poemDate,\r\n            slug: filename.replace(\".md\", \"\"),\r\n            excerpt: extractExcerpt(content),\r\n        };\r\n        })\r\n        .filter((poem) => {\r\n            if (!poem.date) return true; \r\n            return poem.date <= now;\r\n        })\r\n        .sort((a, b) => {\r\n            if (!a.date || !b.date) return 0;\r\n            return b.date - a.date;\r\n        })\r\n        .map((poem) => ({\r\n            ...poem,\r\n            date: poem.date\r\n                ? poem.date.toISOString().split(\"T\")[0]\r\n                : \"No Date Added\",\r\n        }));\r\n    return poems;\r\n}\r\n"],"names":[],"mappings":"gxBAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OAWO,eAAe,QCHkB,QAAQ,EDK5C,MAAO,GADuB,aCHxB,EAAQ,EAAA,OAAE,CAAC,WAAW,CAAC,GAAU,MAAM,CAAC,GAAK,EAAE,QAAQ,CAAC,QACxD,EAAM,IAAI,KAEF,EACT,GAAG,CAAC,AAAC,IACN,IAAM,EAAO,EAAA,OAAE,CAAC,YAAY,CAAC,CAAA,EAAG,EAAS,CAAC,EAAE,EAAA,CAAU,CAAE,QAClD,MAAE,CAAI,SAAE,CAAO,CAAE,CAAG,CAAA,EAAA,EAAA,OAAA,AAAM,EAAC,GAC3B,EAAW,EAAK,IAAI,CAAG,IAAI,KAAK,EAAK,IAAI,EAAI,KAEnD,OADA,QAAQ,GAAG,CAAC,iBAAoB,GACzB,CACH,MAAO,EAAK,KAAK,CACjB,KAAM,EACN,KAAM,EAAS,OAAO,CAAC,MAAO,IAC9B,QAvBZ,AAuBqB,SAvBZ,AAAe,CAAO,CAAE,EAAW,EAAE,EAM1C,OAAO,AALM,EACR,OAAO,CAAC,WAAY,IACpB,OAAO,CAAC,OAAQ,KAChB,IAAI,GAEG,KAAK,CAAC,KAAK,KAAK,CAAC,EAAG,GAAU,IAAI,CAAC,IACnD,EAgBoC,EAC5B,CACA,GACC,MAAM,CAAC,AAAC,GACL,CAAK,EAAK,CAAN,GAAU,EAAE,AACT,EAAK,IAAI,CADO,CACH,GAEvB,IAAI,CAAC,CAAC,EAAG,IACN,AAAI,AAAC,EAAE,IAAI,EAAK,EAAD,AAAG,IAAI,CACf,CADiB,CACf,IAAI,CAAG,EAAE,IAAI,CADS,GAGlC,GAAG,CAAE,AAAD,IAAW,CACZ,EADW,CACR,CAAI,CACP,KAAM,EAAK,IAAI,CACT,EAAK,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CACrC,gBACV,CAAC,GDzBQ,GAAG,CAAC,IAAK,AAAC,CAAE,KAAM,EAAE,IAAI,CAAC,CAAC,CAC3C,CAEe,eAAe,EAAS,QAAE,CAAM,CAAE,EAC7C,MAAM,MAAE,CAAI,CAAE,CAAG,MAAM,EACjB,GAdA,EAAO,CAAC,CAcD,UAdY,EAcJ,AAdM,EAAK,GAAG,CAAC,CAEhC,AAAC,EAAA,OAAE,CAAC,UAAU,CAAC,IAAO,CAAA,EAAA,EAAA,QAAA,AAAQ,IAE3B,CAAA,EAAA,EAAA,OAAA,AAAM,EAAC,EAAA,OAAE,CAAC,YAAY,CAAC,EAAM,UAYpC,MACI,CAAA,EAAA,EAAA,IAAA,EAAC,UAAA,CAAQ,UAAU,gCACnB,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,UAAI,EAAK,IAAI,CAAC,KAAK,GAEpB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAa,CAAA,CAAC,cAAe,CAAC,EAAA,OAAS,CAAC,UACpC,EAAK,OAAO,KAIzB"}